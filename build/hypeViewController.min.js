!function(window){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),Array.prototype.clone=function(){return this.slice()};var View=function(){this.root=null,this.stage=[]};View.prototype.update=function(){for(var i=0;i<this.stage.length;i++)this.stage[i].update()},View.prototype.addViewObject=function(e,id){if(id=id?id:e.id,!id)return null;var o=new ViewObject(e,id,!1);return this.stage.push(o),o},View.prototype.getViewObject=function(id){for(var i=0;i<this.stage.length;i++){var o=this.stage[i];if(o.id===id)return o}return null};var ViewObject=function(element,id){this.element=element,this.id=id,this.isCanvas=this.isCanvas?!0:!1;var props={};this.setProperty=function(name,value){return props[name]=value,this},this.getProperty=function(name){return props[name]}};ViewObject.prototype.update=function(){if(!this.isCanvas){var text=this.getProperty("text"),textNode=this.getProperty("textNode");"undefined"!=typeof text&&"undefined"!=typeof textNode&&(textNode.textContent=text)}},ViewObject.prototype.setText=function(text){if(this.setProperty("text",text),!this.isCanvas&&!this.getProperty("textNode")){var textNode;for(i=0;i<this.element.childNodes.length;i++)this.element.childNodes[i].nodeType==document.TEXT_NODE&&(textNode=this.element.childNodes[i]);textNode=textNode?textNode:document.createTextNode(text),this.setProperty("textNode",textNode),this.element.appendChild(textNode)}return this},ViewObject.prototype.setColor=function(r,g,b){return this.isCanvas||(this.element.style.color="rgb("+r+","+g+","+b+")"),this},ViewObject.prototype.setBackgroundColor=function(r,g,b){return this.isCanvas||(this.element.style.backgroundColor="rgb("+r+","+g+","+b+")"),this};var EventManager=function(DOMelement,namespace){this.DOMelement=DOMelement?DOMelement:document,this.namespace=namespace?namespace:""};EventManager.prototype.addEventListener=function(event,handler){this.DOMelement.addEventListener(this.namespace+event,handler,!1)},EventManager.prototype.removeEventListener=function(event,handler){this.DOMelement.removeEventListener(this.namespace+event,handler,!1)},EventManager.prototype.send=function(event,data){var e;e="undefined"==typeof data?new Event(this.namespace+event):new CustomEvent(this.namespace+event,{detail:data}),this.DOMelement.dispatchEvent(e)};var HypeViewController=function(){var that=this;this.view=new View,this.eventManager=new EventManager(document,"HVC:");var props={};this.setProperty=function(name,value){return props[name]=value,this},this.getProperty=function(name){return props[name]};var count=0,update=function(){requestAnimFrame(update),count++,that.eventManager.send("tick",count),that.view.update()};this.start=function(){update()}};window.HypeViewController=HypeViewController}(window),window.HVC=new HypeViewController;